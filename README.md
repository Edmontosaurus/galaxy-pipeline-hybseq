# Hyb-Seq in Galaxy

## Description

HybPiper is one of the current most convenient ways to process Hybrid sequencing (Hyb-Seq) data. While it is great at what it does, the people who would like to use it most, scientists, often don't know their way around a commandline-based tool and its flags/inputs. Considering HybPiper is a tool run exclusively from the commandline, this could be a problem for some people doing research involving Hyb-Seq data. 

The tools in this repository aim to make HybPiper available in Galaxy, which, in short, is a workflow and pipeline platform that can link different tools together. 
It has the benefit of a graphical user interface (GUI) which makes it so anyone who knows how to navigate a webpage can use it. 

With these Galaxy tools, the aim is to make HybPiper and Hyb-Seq data analysis accessible to more people.

## Future plans

* The inclusion of the generate_heatmap function already available in HybPiper to the HybPiper Galaxy tool.
* The inclusion of the retrieve paralogs functionality  already available in HybPiper to the HybPiper Galaxy tool.

## Documentation

Guides, documentation and tutorials on how to use HybPiper in general. Are already available at the original [HybPiper GitHub repository](https://github.com/mossmatters/HybPiper/wiki "HybPiper Github Wiki").
This Readme file goes into detail about the Galaxy tool wrapper itself. 
Additional Wrapper files that with documentation that goes more in-depth, can be found in the /tools directory in each tool directory itself.
Each tool has its own readme.md file with additional information.
The links in the Tools section below can be used to access more documentation in the form of the mentioned readme.md files that go more in-depth about the tools, how to install them and how to use them.

## Tools

### Hybpiper Galaxy Tool [Link](https://github.com/naturalis/galaxy-pipeline-hybseq/tree/main/tools/hybpiper_galaxy "Hybpiper Galaxy Wrapper folder") 

A wrapper for the HybPiper pipeline to be used as a single tool in Galaxy. It takes a ZIP file with reads in FASTQ format and a single FASTA file with target sequences and runs HybPiper. The result is another zip file with all of the output of the HybPiper pipeline.

### Extract Loci Tool [Link](https://github.com/naturalis/galaxy-pipeline-hybseq/tree/main/tools/hybpiper_extract_loci)

A Galaxy tool designed to take the ZIP archive generated by the HybPiper Galaxy tool above, and extract the sequence files (with options for FNA, FAA and intron sequence files) to be used in the creation of Multiple Sequence Alignments (MSA's).

### Hybpiper Analysis tool [Link](https://github.com/naturalis/galaxy-pipeline-hybseq/tree/main/tools/hybpiper_analysis)

A Galaxy tool designed to take the ZIP archive with folders for each locus generated by the Extract Loci tool above, concatenate the sequence files into one FASTA file per locus, then run MUSCLE to generate an alignment in phylip format for each locus and concatenate them into a supermatrix for further phylogenetic inference.

## Inspiration and Credits

HybSeq is a data generation technique that constitutes a hybrid between shotgun high-throughput sequencing
and amplicon sequencing. The technique results in markers suitable for phylogenomics (because they are 
single copy, universally present, and evolve at the optimal rate) by targeted sequencing using predefined
bait kits, such as [developed by Kew](https://pubmed.ncbi.nlm.nih.gov/31477409/) and others. As such, the
sequencing results in multiplexed FASTQ data that both needs to be demultiplexed back to the input species
as well as sorted by the various baits. The ideal end result is a set of as many multiple sequence alignments
(MSAs) as there were baits, each containing as many rows as there were species, as the input for a multi-marker
phylogenetic analysis yielding a robust tree. In this repository, the artefacts are developed to achieve
this ideal end state. The repository is inspired by the following prior art:

- [Nikolov et al., 2019](https://doi.org/10.1111/nph.15732) - a seminal paper describing how to resolve 
  the phylogenetic backbone of the Brassicaceae using HybSeq. The paper describes an informal reference
  pipeline.
- [brassicaceae-hybseq-pipeline](https://github.com/naturalis/brassicaceae-hybseq-pipeline) - an 
  implementation of the Nikolov et al. pipeline using snakemake. The implementation is not quite complete
  but very close, lacking the last few steps of MSA file conversion, concatenation, and phylogenetics.
- [galaxy-tool-hybseq](https://github.com/naturalis/galaxy-tool-hybseq) - a first attempt to port the
  snakemake pipeline to Galaxy. Many of the tools used by Nikolov et al. are already available in Galaxy's
  package management system (the 'tool shed') but some are missing. This repo attempts to wrap those missing
  tools, especially YASRA.
- [HybPiper](https://bsapubs.onlinelibrary.wiley.com/doi/10.3732/apps.1600016) - a more current HybSeq
  pipeline. It is very possible that this is preferable over the Nikolov et al. pipeline. This needs to be
  investigated.
- [Naturalis Galaxy Portal](https://galaxy.naturalis.nl/), a local install of the Galaxy workflow management
  system. This is where the wrappers for the different pipeline steps will be deployed eventually. The 
  portal is administered by Dick Groenenberg.
  
# Running the HybPiper Tools
## Step-by-step Guide

Coming soon!
